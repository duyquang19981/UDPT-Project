CREATE DATABASE QUESTIONDB;
USE QUESTIONDB;
CREATE TABLE ADMIN
(
	ID_ADMIN INT AUTO_INCREMENT PRIMARY KEY,
    NAME TEXT CHARACTER SET utf8 COLLATE utf8_unicode_ci NOT NULL,
    USERNAME TEXT NOT NULL UNIQUE,
    PASS TEXT NOT NULL,
    ROLE INT,
    NOTIFICATION_YES INT,
    STATUS INT
);

CREATE TABLE NOTIFICATION
(
	ID_NOTI INT AUTO_INCREMENT PRIMARY KEY,
    ID_QUESTION INT,
    ID_ANSWER INT,
    CONTENT TEXT CHARACTER SET utf8 COLLATE utf8_unicode_ci NOT NULL,
    CREATED DATETIME
);

CREATE TABLE NOTIFICATION_ADMIN
(
	ID_NA INT AUTO_INCREMENT PRIMARY KEY,
    NOTI_ID INT NOT NULL,
    ADMIN_ID INT NOT NULL,
    STATUS INT 
);

CREATE TABLE REPORT(
	ID_REPORT INT AUTO_INCREMENT PRIMARY KEY,
    ID_OWNER INT NOT NULL,
    ID_QUESTION INT NOT NULL,
    REASON TEXT CHARACTER SET utf8 COLLATE utf8_unicode_ci NOT NULL,
    CREATED DATETIME
);

CREATE TABLE USER_ACCOUNT
(
	ID_USER INT AUTO_INCREMENT PRIMARY KEY,
    NAME TEXT CHARACTER SET utf8 COLLATE utf8_unicode_ci NOT NULL,
    IMAGE TEXT DEFAULT NULL,
    EMAIL TEXT NOT NULL,
    BIRTH DATE,
    PHONE TEXT NOT NULL,
    USERNAME TEXT NOT NULL,
    PASSWORD TEXT NOT NULL,
    CREATED DATETIME,
    STATUS INT DEFAULT 1
);
CREATE TABLE TAG
(
    ID_TAG INT AUTO_INCREMENT PRIMARY KEY,
    MOD_ID INT NOT NULL,
    DESCRIPTION TEXT CHARACTER SET utf8 COLLATE utf8_unicode_ci NOT NULL,
    STATUS INT 
);

CREATE TABLE ANSWER
(
	ID_ANSWER INT AUTO_INCREMENT PRIMARY KEY,
    ID_QUESTION INT NOT NULL,
    ID_USER INT NOT NULL,
    MOD_ID INT NOT NULL,
    CONTENT VARCHAR(500) CHARACTER SET utf8 COLLATE utf8_unicode_ci NOT NULL,
    CREATED DATETIME,
    ACCEPT_DAY DATE,
    REFERENCELINK TEXT,
    REFERENCEIMAGE TEXT,
    STATUS INT
);

CREATE TABLE QUESTION_TAG
(
	QT_ID INT AUTO_INCREMENT PRIMARY KEY,
    QUESTION_ID INT NOT NULL,
    TAG_ID INT NOT NULL
);

CREATE TABLE QUESTION
(
    ID_QUESTION INT AUTO_INCREMENT PRIMARY KEY,
    OWNER_ID INT NOT NULL,
    CATEGORY_ID INT NOT NULL,
    MOD_ID INT ,
    DESCRIPTION TEXT CHARACTER SET utf8 COLLATE utf8_unicode_ci NOT NULL,
    LIKES INT,
    CREATED DATETIME,
    ACCEPT_DAY DATE,
    STATUS INT
);

CREATE TABLE RATING
(
    ID_RATING INT AUTO_INCREMENT PRIMARY KEY,
    OWNER_ID INT NOT NULL,
    QUESTION_ID INT,
    ANSWER_ID INT,
    STAR INT,
    CREATED DATETIME
);

CREATE TABLE CATEGORY_QUES
(
    CATEGORY_ID INT AUTO_INCREMENT PRIMARY KEY,
    MOD_ID INT NOT NULL,
    NAME TEXT CHARACTER SET utf8 COLLATE utf8_unicode_ci NOT NULL,
    CREATED DATETIME,
    STATUS INT
);

CREATE TABLE QUESTION_LABEL
(
	QL_ID INT AUTO_INCREMENT PRIMARY KEY,
    QUESTION_ID INT NOT NULL,
    LABEL_ID INT NOT NULL
);

CREATE TABLE LABEL
(
    ID_LABEL INT AUTO_INCREMENT PRIMARY KEY,
    MOD_ID INT NOT NULL,
    DESCRIPTION TEXT CHARACTER SET utf8 COLLATE utf8_unicode_ci NOT NULL,
    STATUS INT 
);

ALTER TABLE notification ADD FOREIGN KEY(ID_QUESTION) REFERENCES question(id_question);
ALTER TABLE notification ADD FOREIGN KEY(id_answer) REFERENCES answer(id_answer);
ALTER TABLE notification_admin ADD FOREIGN KEY(noti_id) REFERENCES notification(id_noti);
ALTER TABLE notification_admin ADD FOREIGN KEY(admin_id) REFERENCES admin(id_admin);
ALTER TABLE report ADD FOREIGN KEY(id_owner) REFERENCES user_account(id_user);
ALTER TABLE report ADD FOREIGN KEY(id_question) REFERENCES question(id_question);
ALTER TABLE tag ADD FOREIGN KEY(mod_id) REFERENCES admin(id_admin);
ALTER TABLE answer ADD FOREIGN KEY(mod_id) REFERENCES admin(id_admin);
ALTER TABLE answer ADD FOREIGN KEY(id_user) REFERENCES user_account(id_user);
ALTER TABLE answer ADD FOREIGN KEY(id_question) REFERENCES question(id_question);
ALTER TABLE question_tag ADD FOREIGN KEY(question_id) REFERENCES question(id_question);
ALTER TABLE question_tag ADD FOREIGN KEY(tag_id) REFERENCES tag(id_tag);
ALTER TABLE question ADD FOREIGN KEY(owner_id) REFERENCES user_account(id_user);
ALTER TABLE question ADD FOREIGN KEY(category_id) REFERENCES category_ques(category_id);
ALTER TABLE question ADD FOREIGN KEY(mod_id) REFERENCES admin(id_admin);
ALTER TABLE rating ADD FOREIGN KEY(OWNER_ID) REFERENCES admin(id_admin);
ALTER TABLE rating ADD FOREIGN KEY(question_ID) REFERENCES question(id_question);
ALTER TABLE rating ADD FOREIGN KEY(answer_ID) REFERENCES ANSWER(id_answer);
ALTER TABLE category_ques ADD FOREIGN KEY(mod_id) REFERENCES admin(id_admin);
ALTER TABLE question_label ADD FOREIGN KEY(question_id) REFERENCES question(id_question);
ALTER TABLE question_label ADD FOREIGN KEY(label_id) REFERENCES label(id_label);
ALTER TABLE label ADD FOREIGN KEY(mod_id) REFERENCES admin(id_admin);

-- DEFAULT ADMIN

INSERT INTO ADMIN(name,username,pass,role,NOTIFICATION_yes,status) VALUES(N'Nguyễn Phạm Anh Tú', 'ADMIN','MTIzNDU2',1,0,1);
INSERT INTO `admin` ( `NAME`, `USERNAME`, `PASS`, `ROLE`, `NOTIFICATION_YES`, `STATUS`) VALUES ('TRẦN DUY QUANG', 'admin1', '$2y$10$MjEZAHgxXgp9m3fe5Z2WSeFUwBFtRLuHx6Vt0toIt7x8jZPybJn1a', '1', '1', '1');
INSERT INTO ADMIN(name,username,pass,role,NOTIFICATION_yes,status) VALUES(N'Nguyễn Văn Tâm', 'ADMIN2','MTIzNDU2',1,0,1);
INSERT INTO ADMIN(name,username,pass,role,NOTIFICATION_yes,status) VALUES(N'Lê Quang Quí', 'ADMIN3','MTIzNDU2',1,0,1);

INSERT INTO user_account( NAME, email, birth, phone, username, PASSWORD, created ) VALUES( N'Nguyễn Phạm Anh Tú', 'tubato1999@gmail.com', '1999/06/02', '0858456152', 'tubato1999', 'MTIzNDU2', '2021/05/08' );
INSERT INTO user_account( NAME, email, birth, phone, username, PASSWORD, created ) VALUES( N'Nguyễn Phúc Thạnh', 'npthanh99@gmail.com', '1999/05/09', '0845775112', 'npthanh99', 'MTIzNDU2', '2021/05/08' );
INSERT INTO user_account( NAME, email, birth, phone, username, PASSWORD, created ) VALUES( N'Nguyễn Văn Quân', 'npquan99@gmail.com', '1999/05/09', '0845775634', 'nvquan99', 'MTIzNDU2', '2021/05/08' );
INSERT INTO user_account( NAME, email, birth, phone, username, PASSWORD, created ) VALUES( N'Trần Đình Sang', 'tdsang99@gmail.com', '1999/05/09', '084134572', 'tdsang99', 'MTIzNDU2', '2021/05/08' );
INSERT INTO user_account( NAME, email, birth, phone, username, PASSWORD, created ) VALUES( N'Nguyễn Phú Quý', 'npquy99@gmail.com', '1999/05/09', '083475142', 'npquy99', 'MTIzNDU2', '2021/05/08' );
INSERT INTO user_account( NAME, email, birth, phone, username, PASSWORD, created ) VALUES( N'Nguyễn Chí Thanh', 'ncthanh99@gmail.com', '1999/05/09', '0757425486', 'ncthanh99', 'MTIzNDU2', '2021/05/08' );
INSERT INTO user_account( NAME, email, birth, phone, username, PASSWORD, created ) VALUES( N'Nguyễn Văn Quyền', 'nvquyen99@gmail.com', '1999/05/09', '0357426842', 'nvquyen99', 'MTIzNDU2', '2021/05/08' );
INSERT INTO user_account( NAME, email, birth, phone, username, PASSWORD, created ) VALUES( N'Huỳnh Tấn Thành', 'htthanh@gmail.com', '1999/05/09', '0357412596', 'htthanh99', 'MTIzNDU2', '2021/05/08' );

INSERT INTO LABEL(MOD_ID,DESCRIPTION,STATUS) VALUES(1,N'BUỒN',1);
INSERT INTO LABEL(MOD_ID,DESCRIPTION,STATUS) VALUES(2,'HAHA',1);
INSERT INTO LABEL(MOD_ID,DESCRIPTION,STATUS) VALUES(3,N'THẢ TIM',1);
INSERT INTO LABEL(MOD_ID,DESCRIPTION,STATUS) VALUES(4,N'TỨC GIẬN',1);
INSERT INTO LABEL(MOD_ID,DESCRIPTION,STATUS) VALUES(2,N'THƯƠNG THƯƠNG',1);
INSERT INTO LABEL(MOD_ID,DESCRIPTION,STATUS) VALUES(3,'WOW',1);
INSERT INTO LABEL(MOD_ID,DESCRIPTION,STATUS) VALUES(1,'LIKE',1);

INSERT INTO TAG(MOD_ID,DESCRIPTION,STATUS) VALUES(1,N'AD vào xem thử có đúng không',1);
INSERT INTO TAG(MOD_ID,DESCRIPTION,STATUS) VALUES(2,N'AD xem xét vấn đề này',1);
INSERT INTO TAG(MOD_ID,DESCRIPTION,STATUS) VALUES(3,N'AD thấy hay không',1);
INSERT INTO TAG(MOD_ID,DESCRIPTION,STATUS) VALUES(4,N'AD',1);

INSERT INTO CATEGORY_QUES(MOD_ID,NAME,CREATED,STATUS) VALUES(2,N'VẤN ĐỀ 1','2021/05/08',1);
INSERT INTO CATEGORY_QUES(MOD_ID,NAME,CREATED,STATUS) VALUES(1,N'VẤN ĐỀ 2','2021/05/08',1);
INSERT INTO CATEGORY_QUES(MOD_ID,NAME,CREATED,STATUS) VALUES(4,N'VẤN ĐỀ 3','2021/05/08',1);
INSERT INTO CATEGORY_QUES(MOD_ID,NAME,CREATED,STATUS) VALUES(3,N'VẤN ĐỀ 4','2021/05/08',1);
INSERT INTO CATEGORY_QUES(MOD_ID,NAME,CREATED,STATUS) VALUES(1,N'VẤN ĐỀ 5','2021/05/08',1);
INSERT INTO CATEGORY_QUES(MOD_ID,NAME,CREATED,STATUS) VALUES(1,N'VẤN ĐỀ 6','2021/05/08',1);
INSERT INTO CATEGORY_QUES(MOD_ID,NAME,CREATED,STATUS) VALUES(1,N'VẤN ĐỀ 7','2021/05/08',1);

INSERT INTO QUESTION(OWNER_ID,CATEGORY_ID,MOD_ID,DESCRIPTION,LIKES,CREATED,ACCEPT_DAY,STATUS) VALUES(1,3,2,N'CÂU HỎI 1',50,'2021/05/10','2021/05/10',1);
INSERT INTO QUESTION(OWNER_ID,CATEGORY_ID,MOD_ID,DESCRIPTION,LIKES,CREATED,ACCEPT_DAY,STATUS) VALUES(2,3,2,N'CÂU HỎI 2',50,'2021/05/10','2021/05/10',1);
INSERT INTO QUESTION(OWNER_ID,CATEGORY_ID,MOD_ID,DESCRIPTION,LIKES,CREATED,ACCEPT_DAY,STATUS) VALUES(4,3,2,N'CÂU HỎI 3',50,'2021/05/10','2021/05/10',1);
INSERT INTO QUESTION(OWNER_ID,CATEGORY_ID,MOD_ID,DESCRIPTION,LIKES,CREATED,ACCEPT_DAY,STATUS) VALUES(5,3,2,N'CÂU HỎI 4',50,'2021/05/10','2021/05/10',1);
INSERT INTO QUESTION(OWNER_ID,CATEGORY_ID,MOD_ID,DESCRIPTION,LIKES,CREATED,ACCEPT_DAY,STATUS) VALUES(2,4,3,N'CÂU HỎI 5',50,'2021/05/11','2021/05/11',1);
INSERT INTO QUESTION(OWNER_ID,CATEGORY_ID,MOD_ID,DESCRIPTION,LIKES,CREATED,ACCEPT_DAY,STATUS) VALUES(6,5,3,N'CÂU HỎI 6',50,'2021/05/11','2021/05/11',1);
INSERT INTO QUESTION(OWNER_ID,CATEGORY_ID,MOD_ID,DESCRIPTION,LIKES,CREATED,ACCEPT_DAY,STATUS) VALUES(4,2,3,N'CÂU HỎI 7',50,'2021/05/11','2021/05/11',1);
INSERT INTO QUESTION(OWNER_ID,CATEGORY_ID,MOD_ID,DESCRIPTION,LIKES,CREATED,ACCEPT_DAY,STATUS) VALUES(8,7,3,N'CÂU HỎI 8',50,'2021/05/11','2021/05/11',1);
INSERT INTO QUESTION(OWNER_ID,CATEGORY_ID,MOD_ID,DESCRIPTION,LIKES,CREATED,ACCEPT_DAY,STATUS) VALUES(5,5,4,N'CÂU HỎI 9',50,'2021/05/12','2021/05/12',1);
INSERT INTO QUESTION(OWNER_ID,CATEGORY_ID,MOD_ID,DESCRIPTION,LIKES,CREATED,ACCEPT_DAY,STATUS) VALUES(1,2,1,N'CÂU HỎI 10',50,'2021/05/13','2021/05/13',1);

INSERT INTO QUESTION_LABEL(QUESTION_ID,LABEL_ID) VALUES(5,3);
INSERT INTO QUESTION_LABEL(QUESTION_ID,LABEL_ID) VALUES(3,1);
INSERT INTO QUESTION_LABEL(QUESTION_ID,LABEL_ID) VALUES(2,5);
INSERT INTO QUESTION_LABEL(QUESTION_ID,LABEL_ID) VALUES(4,6);
INSERT INTO QUESTION_LABEL(QUESTION_ID,LABEL_ID) VALUES(8,2);
INSERT INTO QUESTION_LABEL(QUESTION_ID,LABEL_ID) VALUES(6,3);

INSERT INTO QUESTION_TAG(QUESTION_ID,TAG_ID) VALUES(5,3);
INSERT INTO QUESTION_TAG(QUESTION_ID,TAG_ID) VALUES(6,1);
INSERT INTO QUESTION_TAG(QUESTION_ID,TAG_ID) VALUES(1,4);
INSERT INTO QUESTION_TAG(QUESTION_ID,TAG_ID) VALUES(2,3);
INSERT INTO QUESTION_TAG(QUESTION_ID,TAG_ID) VALUES(4,2);
INSERT INTO QUESTION_TAG(QUESTION_ID,TAG_ID) VALUES(3,1);

INSERT INTO REPORT(ID_OWNER,ID_QUESTION,REASION,CREATED) VALUES(1,3,N'CÂU HỎI KHÔNG PHÙ HỢP','2021/05/14');
INSERT INTO REPORT(ID_OWNER,ID_QUESTION,REASION,CREATED) VALUES(2,4,N'CÂU HỎI KHÔNG PHÙ HỢP','2021/05/15');
INSERT INTO REPORT(ID_OWNER,ID_QUESTION,REASION,CREATED) VALUES(3,5,N'CÂU HỎI KHÔNG PHÙ HỢP','2021/05/16');

INSERT INTO ANSWER(ID_QUESTION,ID_USER,MOD_ID,CONTENT,CREATED,ACCEPT_DAY,REFERENCELINK,REFERENCEIMAGE,STATUS) VALUES(2,4,1,N'CÂU TRẢ LỜI 1','2021/05/14','2021/05/14',NULL,NULL,1);
INSERT INTO ANSWER(ID_QUESTION,ID_USER,MOD_ID,CONTENT,CREATED,ACCEPT_DAY,REFERENCELINK,REFERENCEIMAGE,STATUS) VALUES(3,3,1,N'CÂU TRẢ LỜI 2','2021/05/14','2021/05/14',NULL,NULL,1);
INSERT INTO ANSWER(ID_QUESTION,ID_USER,MOD_ID,CONTENT,CREATED,ACCEPT_DAY,REFERENCELINK,REFERENCEIMAGE,STATUS) VALUES(4,2,2,N'CÂU TRẢ LỜI 3','2021/05/15','2021/05/15',NULL,NULL,1);
INSERT INTO ANSWER(ID_QUESTION,ID_USER,MOD_ID,CONTENT,CREATED,ACCEPT_DAY,REFERENCELINK,REFERENCEIMAGE,STATUS) VALUES(5,8,2,N'CÂU TRẢ LỜI 4','2021/05/15','2021/05/15',NULL,NULL,1);
INSERT INTO ANSWER(ID_QUESTION,ID_USER,MOD_ID,CONTENT,CREATED,ACCEPT_DAY,REFERENCELINK,REFERENCEIMAGE,STATUS) VALUES(2,5,3,N'CÂU TRẢ LỜI 5','2021/05/16','2021/05/16',NULL,NULL,1);
INSERT INTO ANSWER(ID_QUESTION,ID_USER,MOD_ID,CONTENT,CREATED,ACCEPT_DAY,REFERENCELINK,REFERENCEIMAGE,STATUS) VALUES(6,6,3,N'CÂU TRẢ LỜI 6','2021/05/16','2021/05/16',NULL,NULL,1);
INSERT INTO ANSWER(ID_QUESTION,ID_USER,MOD_ID,CONTENT,CREATED,ACCEPT_DAY,REFERENCELINK,REFERENCEIMAGE,STATUS) VALUES(3,1,4,N'CÂU TRẢ LỜI 7','2021/05/17','2021/05/17',NULL,NULL,1);
INSERT INTO ANSWER(ID_QUESTION,ID_USER,MOD_ID,CONTENT,CREATED,ACCEPT_DAY,REFERENCELINK,REFERENCEIMAGE,STATUS) VALUES(1,4,4,N'CÂU TRẢ LỜI 8','2021/05/17','2021/05/17',NULL,NULL,1);

INSERT INTO NOTIFICATION(ID_QUESTION,ID_ANSWER,CONTENT,CREATED) VALUES(3,1,'CONTENT 1','2021/05/18');
INSERT INTO NOTIFICATION(ID_QUESTION,ID_ANSWER,CONTENT,CREATED) VALUES(4,2,'CONTENT 2','2021/05/18');
INSERT INTO NOTIFICATION(ID_QUESTION,ID_ANSWER,CONTENT,CREATED) VALUES(2,4,'CONTENT 3','2021/05/19');
INSERT INTO NOTIFICATION(ID_QUESTION,ID_ANSWER,CONTENT,CREATED) VALUES(1,6,'CONTENT 4','2021/05/19');
INSERT INTO NOTIFICATION(ID_QUESTION,ID_ANSWER,CONTENT,CREATED) VALUES(5,5,'CONTENT 5','2021/05/20');
INSERT INTO NOTIFICATION(ID_QUESTION,ID_ANSWER,CONTENT,CREATED) VALUES(6,4,'CONTENT 6','2021/05/20');

INSERT INTO NOTIFICATION_ADMIN(NOTI_ID,ADMIN_ID,STATUS) VALUES(1,3,1);
INSERT INTO NOTIFICATION_ADMIN(NOTI_ID,ADMIN_ID,STATUS) VALUES(2,3,1);
INSERT INTO NOTIFICATION_ADMIN(NOTI_ID,ADMIN_ID,STATUS) VALUES(3,4,1);
INSERT INTO NOTIFICATION_ADMIN(NOTI_ID,ADMIN_ID,STATUS) VALUES(4,4,1);
INSERT INTO NOTIFICATION_ADMIN(NOTI_ID,ADMIN_ID,STATUS) VALUES(5,2,1);
INSERT INTO NOTIFICATION_ADMIN(NOTI_ID,ADMIN_ID,STATUS) VALUES(6,2,1);

INSERT INTO RATING(OWNER_ID,QUESTION_ID,ANSWER_ID,STAR,CREATED) VALUES(1,2,3,9,'2021/05/21');
INSERT INTO RATING(OWNER_ID,QUESTION_ID,ANSWER_ID,STAR,CREATED) VALUES(1,3,4,10,'2021/05/21');
INSERT INTO RATING(OWNER_ID,QUESTION_ID,ANSWER_ID,STAR,CREATED) VALUES(2,5,2,8,'2021/05/22');
INSERT INTO RATING(OWNER_ID,QUESTION_ID,ANSWER_ID,STAR,CREATED) VALUES(2,2,2,7,'2021/05/22');
INSERT INTO RATING(OWNER_ID,QUESTION_ID,ANSWER_ID,STAR,CREATED) VALUES(3,4,1,9,'2021/05/23');
INSERT INTO RATING(OWNER_ID,QUESTION_ID,ANSWER_ID,STAR,CREATED) VALUES(4,6,4,10,'2021/05/24');
INSERT INTO RATING(OWNER_ID,QUESTION_ID,ANSWER_ID,STAR,CREATED) VALUES(4,1,5,9,'2021/05/24');
