
<div class="col-sm-7" style="text-align: left; padding:1%">
    <div class="card" style="width: width: 100%;height: auto;overflow: hidden;padding: 1%;background-color: #fff;border-radius: 5px;box-shadow: 1% ">
        <div class="card-body" style="padding:1%">
            <div class="row">
            <div class="col-md-1">
            <img src="<?php if($question["user_image"] != null){echo $question["user_image"];} else{echo _PUBLIC.'/images/User.png';}  ?>" height="40px" width="40px" style="background-color: transparent;margin-top: -5px; border-radius: 50%;">  
            </div>
            <div class="col-md-9">
            <b style="font-size: 20px;">
            <?php echo $question["username"]?>                            </b>
            <p><?php echo $question["created"]?> </p>
            <b><?php echo $question["category_name"]?> </b>
            
            </div>
            </div>
            <div class="row">
            <div class="col-md-1"></div>
            <div class="col-md-10">
            <p style="background-color: #f6f6f6; padding:2%"><?php echo $question["description"]?></p>
            </div>
            </div>
            <div class="row">
            <div class="col-md-1"></div>
                
            <?php if (isset($question["tags"]) && count($question["tags"]) > 0) {
                    foreach ($question["tags"] as $tag) { ?> 
                        <div class="col-md-1"  style="padding:1%; background-color: #028317; color: white;width: auto; margin-right:1%"><?php echo $tag["DESCRIPTION"];?></div>                      
                        <?php
                        }
                        }
                        ?> 
            </div>
            <div class="row">
            <div class="col-md-9"></div>
            <div>
            <p style="text-align: center;font-size: 15px;"><?php echo $question["likes"]?><span style="margin-left:1%;margin-right:1%; " class="glyphicon glyphicon-thumbs-up"></span><?php echo $question["anser"]?> <span class="glyphicon glyphicon-comment"></span></p>
            </div>
            </div>
        </div>
    </div>
    <div class="card" style="width: width: 100%;height: auto;overflow: hidden;padding: 1%;background-color: #fff;border-radius: 5px;box-shadow: 1%; margin-top:2% ">
        <div class="card-body" style="padding:1%">
            <div  style="text-align: left;">
                <div style="text-align: center;">
                    <b style="font-size: 30px;">Trả lời câu hỏi</b>
                </div>
                <div class="form-group">
                    <label for="exampleFormControlTextarea1" style="font-size: 20px;">Câu trả lời</label>
                    <textarea class="form-control" id="answer_des" name="answer_des" rows="5"></textarea>
                </div>
                <div class="row">
                    <div class="form-group col-md-6">
                        <label for="exampleFormControlSelect1" style="font-size: 20px;">Link tham khảo</label>
                        <input type="text"  placeholder="Link tham khỏa" name="link_tt" id="link_tt" />
                    
                    </div>
                    <div class="form-group col-md-6">
                        <label for="exampleFormControlSelect1" style="font-size: 20px;">Link tham khảo</label>
                        <input type="text"  placeholder="Link hình" name="link_hinh" id="link_hinh" />
                    
                    </div>
                </div>
                
                <div style="text-align: right;">
                    <button type="submit" class="btn btn-primary" id="createAns">Đăng câu trả lời</button>
                </div>
            </div>
        </div>
    </div>
    <div class="card" style="width: width: 100%;height: auto;overflow: hidden;padding: 1%;background-color: #fff;border-radius: 5px;box-shadow:1%; margin-top:2% ">
        <div class="card-body" style="padding:1%">
            <div class="row">
                <b style="font-size: 35px; margin-left:2%">Trả lời</b>
            </div>
            <!-- // câu trả lời cho người dùng -->
            <?php if (isset($answer) && count($answer) > 0) {
            foreach ($answer as $ans) { ?> 
                <div>
                    <hr  style="width:100%; size:10px; align:center " />
                    <div class="row">
                        <div class="col-md-1">
                            <img src="<?php if($ans["user_image"] != null){echo $ans["user_image"];} else{echo _PUBLIC.'/images/User.png';}  ?>" height="40px" width="40px" style="background-color: transparent;margin-top: -5px; border-radius: 50%;">  
                        </div>
                        <div class="col-md-9">
                            <b style="font-size: 20px;"><?php echo $ans["username"]?> </b>
                            <p><?php echo $ans["created"]?> </p>
                        </div>

                    </div>
                    <div class="row">
                        <div class="col-md-1"></div>
                        <div class="col-md-11">
                            <p style="background-color: #f6f6f6; padding:2%"><?php echo $ans["content"]?></p>
                            
                            <?php 
                            if($ans["referencelink"] != null)
                            {
                                echo '<b style="font-size: 15px; margin-top:1%"> Nguồn tham khảo:<a href="'.$ans["referencelink"].'" style="text-decoration: none;" target="_blank">Click here!!</a>';
                            }
                            
                            ?>
                                
                            
                            </b>
                        </div>
                    </div>
                    <?php if($ans["referenceimage"] != null):?>
                    <div class="row" style=" margin-top:3%">
                        <div class="col-md-1"></div>
                        <div class="col-md-10">
                            <b style="font-size: 15px; margin-top:3%"> Hình ảnh: </b>
                            <a type="button" class="btn btn-info" href="<?php echo $ans["referenceimage"]?>" style="width:100px; height:100px;margin:2%;background-image: url('<?php echo $ans["referenceimage"]?>'); background-size: 100px 100px;   " target="_blank"></a>
                            (click vào hình để mở bằng trang khác)
                        </div>
                    </div>
                    <?php endif;?>
                    
                
                </div>
            <?php
                }
            } ?>
        </div>
    </div>    
</div>
<div class="col-sm-3" style="text-align: left; padding:1%">
    <div class="card" style="width: 100%;height: auto;overflow: hidden;padding: 1%;background-color: #fff;border-radius: 5px;box-shadow: 1% ">
        <div class="card-body" style="padding:2%">
            <div class="row">
                <div class="col-md-2">
                    <img src="/UDPT-PROJECT/image/430945avatar.jpg" height="40px" width="40px" style="background-color: transparent;margin-top: 5px; border-radius: 10%;">  
                </div>
                <div class="col-md-9" style="margin-left:1%">
                    <div class="row">
                        <b style="font-size: 16px;">Nguyễn Phạm Anh Tú</b>
                        <p style="font-size: 12px;">tubato1999@gmail.com</p>
                    </div>
                </div>
            </div>
            <div class="row" style="margin-top:2%">
                <p class="col-md-12" style="font-size: 15px;">Số câu hỏi: </p>
                <p class="col-md-12" style="font-size: 15px;">Số câu trả lời: </p>
            </div>
        </div>
    </div>

    <div class="card" style="width: 100%;height: auto;overflow: hidden;padding: 1%;background-color: #00000000;border-radius: 5px;box-shadow: 1%; margin-top: 2% ">
        <div class="card-body" style="padding:2%">
            <div style="text-align: center; font-size: 20px;color:#db9b00;">
                <a href="" style="color:#db9b00;"><B>THÀNH VIÊN HĂNG HÁI NHẤT</B></a>
            </div>
            
        </div>  
    </div>
    <div class="card" style="width: 100%;height: auto;overflow: hidden;padding: 1%;background-color: #00000000;border-radius: 5px;box-shadow: 1%; margin-top: 2%">
        <div class="card-body" style="padding:2%">
        <div style="text-align: center; font-size: 20px;">
            <B >Bạn muốn hỏi điều gì?</B>
        </div>
        <a class="btn-add-ques" style="background-color: #db9b00;padding: 12px;display: block;text-align: center;color: #fff;border-radius: 5px;text-transform: uppercase;font-weight: 700;margin-top:3%"><img  src="https://hoidap247.com/static/img/icon-question.png" style="margin-right:2%"><span>Đặt câu hỏi</span></a>
        </div>
    </div>
</div>
<script type="text/javascript">
  $(document).ready(function() {

    $("#createAns").on("click", function(e) {
      $("#loadMe").modal({
        backdrop: "static", //remove ability to close modal with click
        keyboard: false, //remove option to close with keyboard
        show: true //Display loader!
      });
      var datas = {
        "id_question": <?php echo $question["id_question"] ?>,
        "content": $('#answer_des').val(),
        "referencelink": $('#link_tt').val(),
        "referenceimage": $('#link_hinh').val(),
        "id_user": "<?php echo $_SESSION["user_id"] ?>",
        "jwt": "<?php echo $_SESSION["jwt"] ?>"
      }
      $.ajax({
        contentType: 'application/json; charset=utf-8',
        type: "POST",
        url: "<?php echo (_API_ROOT . 'answer/create.php') ?>",
        dataType: "json",
        success: function(result, status, xhr) {
          $("#loadMe").modal("hide");
          alert("Gửi câu trả lời thành công");
          $('#answer_des').val("");
          $('#link_tt').val("");
          $('#link_hinh').val("");
        },
        error: function(xhr, status, error) {
          if (xhr.status == 401) {
            $("#loadMe").modal("hide");
            alert("Phiên đăng nhập của bạn đã hết. Xin vui lòng đăng nhập lại");
            window.location = "<?php echo _WEB_ROOT . "/login/logout"; ?>";
          } else {
            $("#loadMe").modal("hide");
            alert("Result: " + status + " " + error + " " + xhr.status + " " + xhr.statusText)
          }

        },
        data: JSON.stringify(datas)
      });

    });
  });
</script>


